import{m as Z,d as m,s as h,e as ee,p as M,o as v,j as a,a as t,c as f,b as _,f as n,k as i,g as C,v as te,z as B,t as u,F as se,r as oe,A as ae,q as k}from"./app-Cfeasr-S.js";import{_ as le}from"./AppLayout.vue_vue_type_script_setup_true_lang-3KQtrfI4.js";import{a as c,_ as V}from"./Card.vue_vue_type_script_setup_true_lang-DrB2_zzy.js";import{_ as H}from"./Badge.vue_vue_type_script_setup_true_lang-UkqNfKHi.js";import{T as re}from"./Table-BvGLXJPK.js";import{_ as ne}from"./Pagination.vue_vue_type_script_setup_true_lang-BNiL3V7c.js";import{t as g}from"./useToast-DkDgfNCz.js";/* empty css            */const ie={class:"space-y-6"},de={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ue={class:"flex flex-col md:flex-row gap-4"},ce={class:"flex-1"},ve={class:"relative rounded-lg"},me={class:"flex flex-col sm:flex-row gap-4"},fe={class:"w-full sm:w-40"},xe={class:"w-full sm:w-40"},pe={key:0,class:"py-12 flex justify-center"},ge={key:1,class:"py-12 flex justify-center"},we={class:"flex flex-col items-center text-center"},ke={key:2,class:"py-12 flex justify-center"},he={class:"flex flex-col items-center text-center"},ye={class:"text-text-muted max-w-md"},be={class:"mt-4 flex space-x-3"},_e={key:3},Ce={key:0,class:"bg-elevated p-4 rounded-lg mb-4 flex flex-col sm:flex-row items-center justify-between gap-4"},Se={class:"text-sm"},De={class:"font-medium"},Te={class:"flex gap-2"},Le={class:"w-10 px-4 py-3"},Ee=["checked"],Ae={class:"px-4 py-4"},je=["checked","onChange"],ze={class:"px-4 py-4 font-medium"},$e={class:"px-4 py-4 text-text-muted"},Me={class:"px-4 py-4"},Be={class:"px-4 py-4"},Ve={class:"px-4 py-4"},He={class:"px-4 py-4 text-text-muted"},Ne={class:"px-4 py-4 text-right space-x-2 whitespace-nowrap"},Fe={class:"mt-6"},Ie={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Oe={class:"flex min-h-full items-center justify-center p-4"},Re={class:"relative w-full max-w-md transform overflow-hidden rounded-lg bg-surface border border-border shadow-xl transition-all"},qe={class:"px-6 py-4"},Ue={class:"flex items-start space-x-3"},Pe={class:"flex-1"},Ge={class:"text-text"},Je={class:"font-semibold text-danger"},Ke={class:"bg-elevated px-6 py-4 flex items-center justify-end space-x-3"},at=Z({__name:"Index",props:{domains:{}},setup(N){const r=m(N.domains),S=m(!0),F=m(!1),l=m([]),d=m({search:"",status:"",autoTLS:""}),y=m(!1),p=m(null),x=m(!1),D=h(()=>r.value.data.filter(s=>!(d.value.search&&!s.name.toLowerCase().includes(d.value.search.toLowerCase())||d.value.status==="active"&&!s.is_active||d.value.status==="inactive"&&s.is_active||d.value.autoTLS==="enabled"&&!s.auto_ssl||d.value.autoTLS==="disabled"&&s.auto_ssl))),T=h(()=>r.value.data.length>0&&l.value.length===r.value.data.length),L=h(()=>d.value.search!==""||d.value.status!==""||d.value.autoTLS!==""),E=h(()=>l.value.length===0?!1:l.value.every(s=>{const e=r.value.data.find(o=>o.id===s);return e&&e.is_active})),I=s=>{const e=new Date(s);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(e)},A=()=>{d.value={search:"",status:"",autoTLS:""}},O=s=>l.value.includes(s),R=s=>{const e=l.value.indexOf(s);e===-1?l.value.push(s):l.value.splice(e,1)},q=()=>{T.value?l.value=[]:l.value=r.value.data.map(s=>s.id)},U=()=>{l.value=[]},j=()=>{k.visit("/domains/create")},P=s=>{k.visit(`/domains/${s.id}/edit`)},G=s=>{p.value=s,y.value=!0},b=()=>{y.value=!1,p.value=null,x.value=!1},z=async()=>{try{await k.visit(window.location.pathname,{only:["domains"],preserveState:!1,preserveScroll:!1})}catch(s){console.error("Erro ao recarregar via Inertia:",s);try{const e=await fetch("/domains");if(e.ok){const o=await e.json();o.domains&&o.domains.data&&(r.value=o.domains)}}catch(e){console.error("Erro ao fazer fetch manual:",e),window.location.reload()}}},J=async()=>{if(p.value){x.value=!0;try{const s=`/domains/${p.value.id}`;await k.delete(s,{onSuccess:()=>{r.value.data=r.value.data.filter(e=>e.id!==p.value?.id),r.value.total&&r.value.total--,g.success("Domínio excluído","O domínio foi excluído com sucesso."),b(),setTimeout(()=>{z()},100)},onError:e=>{g.error("Erro ao excluir","Não foi possível excluir o domínio."),console.error("Erro ao excluir domínio:",e)}})}catch(s){g.error("Erro ao excluir","Ocorreu um erro inesperado."),console.error("Erro inesperado:",s)}finally{x.value=!1}}},K=()=>{confirm(`Tem certeza que deseja excluir ${l.value.length} domínios?`)&&Q()},Q=async()=>{const s=l.value;let e=0,o=0;for(const w of s)try{const $=`/domains/${w}`;await k.delete($,{onSuccess:()=>{e++,r.value.data=r.value.data.filter(Y=>Y.id!==w)},onError:()=>{o++}})}catch{o++}e>0&&r.value.total&&(r.value.total-=e),e>0&&(g.success("Domínios excluídos",`${e} domínios foram excluídos com sucesso.`),setTimeout(()=>{z()},100)),o>0&&g.error("Erros na exclusão",`${o} domínios não puderam ser excluídos.`),l.value=[]},W=()=>{const s=!E.value;r.value.data=r.value.data.map(e=>l.value.includes(e.id)?{...e,is_active:s}:e),g.success(s?"Domínios ativados":"Domínios desativados",`${l.value.length} domínios foram ${s?"ativados":"desativados"} com sucesso.`)},X=s=>{console.log("Navegando para:",s)};return ee(()=>{S.value=!1}),(s,e)=>(v(),M(le,{title:"Domínios"},{default:a(()=>[t("div",ie,[t("div",de,[e[6]||(e[6]=t("div",null,[t("h1",{class:"text-2xl font-semibold"},"Domínios"),t("p",{class:"text-text-muted mt-1"},"Gerencie os domínios do seu proxy reverso")],-1)),n(c,{onClick:j,variant:"default",class:"sm:self-end"},{icon:a(()=>[...e[4]||(e[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)])]),default:a(()=>[e[5]||(e[5]=i(" Adicionar Domínio ",-1))]),_:1})]),n(V,null,{default:a(()=>[t("div",ue,[t("div",ce,[e[8]||(e[8]=t("label",{for:"search",class:"sr-only"},"Buscar",-1)),t("div",ve,[e[7]||(e[7]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-5 w-5 text-text-muted",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1)),C(t("input",{id:"search","onUpdate:modelValue":e[0]||(e[0]=o=>d.value.search=o),type:"search",class:"block w-full pl-10 pr-3 py-2 border border-border rounded-lg bg-surface focus:outline-none focus:ring-1 focus:ring-accent focus:border-accent",placeholder:"Buscar domínios..."},null,512),[[te,d.value.search]])])]),t("div",me,[t("div",fe,[e[10]||(e[10]=t("label",{for:"status",class:"sr-only"},"Status",-1)),C(t("select",{id:"status","onUpdate:modelValue":e[1]||(e[1]=o=>d.value.status=o),class:"block w-full border border-border rounded-lg bg-surface focus:outline-none focus:ring-1 focus:ring-accent focus:border-accent"},[...e[9]||(e[9]=[t("option",{value:""},"Todos os status",-1),t("option",{value:"active"},"Ativo",-1),t("option",{value:"inactive"},"Inativo",-1)])],512),[[B,d.value.status]])]),t("div",xe,[e[12]||(e[12]=t("label",{for:"autoTLS",class:"sr-only"},"Auto TLS",-1)),C(t("select",{id:"autoTLS","onUpdate:modelValue":e[2]||(e[2]=o=>d.value.autoTLS=o),class:"block w-full border border-border rounded-lg bg-surface focus:outline-none focus:ring-1 focus:ring-accent focus:border-accent"},[...e[11]||(e[11]=[t("option",{value:""},"Todos Auto TLS",-1),t("option",{value:"enabled"},"Habilitado",-1),t("option",{value:"disabled"},"Desabilitado",-1)])],512),[[B,d.value.autoTLS]])]),n(c,{variant:"outline",onClick:A},{default:a(()=>[...e[13]||(e[13]=[i(" Limpar ",-1)])]),_:1})])])]),_:1}),n(V,null,{default:a(()=>[S.value?(v(),f("div",pe,[...e[14]||(e[14]=[t("div",{class:"flex flex-col items-center"},[t("svg",{class:"animate-spin h-10 w-10 text-accent mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),t("p",{class:"text-text-muted"},"Carregando domínios...")],-1)])])):F.value?(v(),f("div",ge,[t("div",we,[e[16]||(e[16]=t("svg",{class:"h-12 w-12 text-danger mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e[17]||(e[17]=t("p",{class:"text-danger font-medium mb-2"},"Erro ao carregar domínios",-1)),e[18]||(e[18]=t("p",{class:"text-text-muted max-w-md"},"Ocorreu um erro ao carregar os dados. Por favor, tente novamente ou contate o suporte.",-1)),n(c,{onClick:e[3]||(e[3]=o=>s.window.location.reload()),variant:"outline",class:"mt-4"},{default:a(()=>[...e[15]||(e[15]=[i(" Tentar novamente ",-1)])]),_:1})])])):D.value.length===0?(v(),f("div",ke,[t("div",he,[e[21]||(e[21]=t("svg",{class:"h-12 w-12 text-text-muted mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1)),e[22]||(e[22]=t("p",{class:"text-text font-medium mb-2"},"Nenhum domínio encontrado",-1)),t("p",ye,u(L.value?"Nenhum domínio corresponde aos filtros aplicados.":"Você ainda não tem nenhum domínio cadastrado."),1),t("div",be,[L.value?(v(),M(c,{key:0,onClick:A,variant:"outline"},{default:a(()=>[...e[19]||(e[19]=[i(" Limpar filtros ",-1)])]),_:1})):_("",!0),n(c,{onClick:j,variant:"default"},{default:a(()=>[...e[20]||(e[20]=[i(" Adicionar Domínio ",-1)])]),_:1})])])])):(v(),f("div",_e,[l.value.length>0?(v(),f("div",Ce,[t("p",Se,[t("span",De,u(l.value.length),1),i(" "+u(l.value.length===1?"domínio selecionado":"domínios selecionados"),1)]),t("div",Te,[n(c,{variant:"outline",size:"sm",onClick:W},{default:a(()=>[i(u(E.value?"Desativar":"Ativar"),1)]),_:1}),n(c,{variant:"danger",size:"sm",onClick:K},{default:a(()=>[...e[23]||(e[23]=[i(" Excluir ",-1)])]),_:1}),n(c,{variant:"ghost",size:"sm",onClick:U},{default:a(()=>[...e[24]||(e[24]=[i(" Cancelar ",-1)])]),_:1})])])):_("",!0),n(re,{"sticky-header":!0,"col-span":7},{header:a(()=>[t("th",Le,[t("input",{type:"checkbox",checked:T.value,onChange:q,class:"rounded border-border text-accent focus:ring-accent"},null,40,Ee)]),e[25]||(e[25]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider"}," Domínio ",-1)),e[26]||(e[26]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider"}," Descrição ",-1)),e[27]||(e[27]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider"}," Auto TLS ",-1)),e[28]||(e[28]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider"}," Status ",-1)),e[29]||(e[29]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider"}," Rotas ",-1)),e[30]||(e[30]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider"}," Criado em ",-1)),e[31]||(e[31]=t("th",{class:"px-4 py-3 text-right text-xs font-medium text-text-muted uppercase tracking-wider"}," Ações ",-1))]),default:a(()=>[(v(!0),f(se,null,oe(D.value,o=>(v(),f("tr",{key:o.id,class:"hover:bg-elevated"},[t("td",Ae,[t("input",{type:"checkbox",checked:O(o.id),onChange:w=>R(o.id),class:"rounded border-border text-accent focus:ring-accent"},null,40,je)]),t("td",ze,u(o.name),1),t("td",$e,u(o.description||"—"),1),t("td",Me,[n(H,{variant:o.auto_ssl?"info":"neutral"},{default:a(()=>[i(u(o.auto_ssl?"Habilitado":"Desabilitado"),1)]),_:2},1032,["variant"])]),t("td",Be,[n(H,{variant:o.is_active?"success":"danger"},{default:a(()=>[i(u(o.is_active?"Ativo":"Inativo"),1)]),_:2},1032,["variant"])]),t("td",Ve,u(o.proxy_rules_count+o.ssl_certificates_count+o.redirect_rules_count),1),t("td",He,u(I(o.created_at)),1),t("td",Ne,[n(c,{variant:"ghost",size:"sm",onClick:w=>P(o)},{default:a(()=>[...e[32]||(e[32]=[i(" Editar ",-1)])]),_:2},1032,["onClick"]),n(c,{variant:"ghost",size:"sm",class:"text-danger",onClick:w=>G(o)},{default:a(()=>[...e[33]||(e[33]=[i(" Excluir ",-1)])]),_:2},1032,["onClick"])])]))),128))]),_:1}),t("div",Fe,[n(ne,{links:r.value.links,onNavigate:X},null,8,["links"])])]))]),_:1})]),y.value?(v(),f("div",Ie,[t("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:b}),t("div",Oe,[t("div",Re,[e[40]||(e[40]=t("div",{class:"bg-danger/10 px-6 py-4 border-b border-border"},[t("div",{class:"flex items-center"},[t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-6 w-6 text-danger",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])]),t("div",{class:"ml-3"},[t("h3",{class:"text-lg font-medium text-text"},"Confirmar Exclusão"),t("p",{class:"text-sm text-text-muted"},"Esta ação não pode ser desfeita.")])])],-1)),t("div",qe,[t("div",Ue,[e[37]||(e[37]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-10 h-10 bg-danger/10 rounded-full flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-danger",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1H9a1 1 0 00-1 1v3M4 7h16"})])])],-1)),t("div",Pe,[t("p",Ge,[e[34]||(e[34]=i(" Tem certeza que deseja excluir o domínio ",-1)),t("span",Je,u(p.value?.name),1),e[35]||(e[35]=i("? ",-1))]),e[36]||(e[36]=t("div",{class:"mt-2 text-sm text-text-muted"},[t("p",null,"Esta ação irá:"),t("ul",{class:"list-disc list-inside mt-1 space-y-1"},[t("li",null,"Remover permanentemente o domínio"),t("li",null,"Excluir todas as regras de proxy associadas"),t("li",null,"Remover certificados SSL relacionados"),t("li",null,"Apagar regras de redirecionamento")])],-1))])])]),t("div",Ke,[n(c,{variant:"outline",onClick:b,disabled:x.value},{default:a(()=>[...e[38]||(e[38]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"]),n(c,{variant:"danger",onClick:J,disabled:x.value},ae({default:a(()=>[i(" "+u(x.value?"Excluindo...":"Excluir Domínio"),1)]),_:2},[x.value?{name:"icon",fn:a(()=>[e[39]||(e[39]=t("svg",{class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1))]),key:"0"}:void 0]),1032,["disabled"])])])])])):_("",!0)]),_:1}))}});export{at as default};
