import{m as R,d as b,y as F,p as k,o as l,j as n,f as a,a as t,k as i,t as r,g as y,v as P,A as H,c as u,b as g,F as h,r as _,n as w,q as c}from"./app-DYmwo6cP.js";import{_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-D8_QylCB.js";import{_ as I}from"./PageLayout.vue_vue_type_script_setup_true_lang-BxSkb2MM.js";import{a as m,_ as f}from"./Card.vue_vue_type_script_setup_true_lang-CBKiSllb.js";import{_ as U}from"./Pagination.vue_vue_type_script_setup_true_lang-C63sjvu8.js";import{u as G}from"./useToast-CQR3QsTO.js";/* empty css            */const J={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8"},O={class:"flex items-center gap-3 mt-4 sm:mt-0"},K={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},Q={class:"flex items-center justify-between"},W={class:"text-2xl font-bold text-text"},X={class:"flex items-center justify-between"},Y={class:"text-2xl font-bold text-success"},Z={class:"flex items-center justify-between"},tt={class:"text-2xl font-bold text-warning"},et={class:"flex items-center justify-between"},st={class:"text-2xl font-bold text-danger"},ot={class:"text-sm"},rt={class:"grid grid-cols-2 gap-4 text-xs"},nt={class:"mt-2"},at={class:"text-xs bg-white p-2 rounded mt-1 overflow-auto"},it={class:"flex flex-col sm:flex-row gap-4"},lt={class:"flex-1"},dt={class:"flex gap-3"},ut={class:"overflow-x-auto"},pt={class:"w-full text-sm"},xt={key:0,class:"border-b border-border"},ct={class:"px-4 py-3"},mt={class:"font-medium text-text"},ft={class:"text-sm text-text-muted"},vt={class:"px-4 py-3"},gt={key:0,class:"space-y-1"},wt={key:0,class:"text-xs text-text-muted"},bt={key:1,class:"text-sm text-text-muted"},kt={class:"px-4 py-3"},yt={class:"px-4 py-3"},ht={key:0},_t={class:"font-medium text-text"},Ct={key:1,class:"text-sm text-text-muted"},St={class:"px-4 py-3"},Et={class:"px-4 py-3 text-center"},Tt={class:"flex items-center gap-2"},jt={class:"px-6 py-4 border-t border-border"},zt=R({__name:"Index",props:{certificates:{},stats:{}},setup($t){const{success:C}=G();b(!1);const v=b(!1),p=F({search:"",status:""}),S=()=>{c.visit("/ssl/create")},E=s=>{c.visit(`/ssl/${s.id}`)},T=async s=>{try{await c.post(`/ssl/${s.id}/renew`,{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{C("Certificado renovado com sucesso!")},onError:()=>{showToast("Erro ao renovar certificado","error")}})}catch{showToast("Erro ao renovar certificado","error")}},j=async s=>{try{await c.post(`/ssl/${s.id}/toggle`,{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{const e=s.auto_renew?"desativada":"ativada";showToast(`Auto renovação ${e} com sucesso!`,"success")},onError:()=>{showToast("Erro ao alterar auto renovação","error")}})}catch{showToast("Erro ao alterar auto renovação","error")}},$=s=>{confirm(`Tem certeza que deseja excluir o certificado para "${s.domain_name}"?`)&&c.delete(`/ssl/${s.id}`,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{showToast("Certificado excluído com sucesso!","success")},onError:()=>{showToast("Erro ao excluir certificado","error")}})},M=async()=>{v.value=!0;try{await c.post("/ssl/renew-all",{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{showToast("Renovação em lote iniciada!","success")},onError:()=>{showToast("Erro ao iniciar renovação em lote","error")},onFinish:()=>{v.value=!1}})}catch{showToast("Erro ao iniciar renovação em lote","error"),v.value=!1}},D=s=>({valid:"Válido",expiring:"Expirando",expired:"Expirado",failed:"Falha",pending:"Pendente"})[s]||s,L=s=>new Date(s).toLocaleDateString("pt-BR"),A=s=>{const e=new Date,d=new Date(s).getTime()-e.getTime(),x=Math.ceil(d/(1e3*60*60*24));return x<0?`Expirou há ${Math.abs(x)} dias`:x===0?"Expira hoje":x===1?"Expira amanhã":`Expira em ${x} dias`},B=s=>{const e=new Date,d=new Date(s).getTime()-e.getTime(),x=Math.ceil(d/(1e3*60*60*24));return x<0?"text-danger":x<=30?"text-warning":"text-text-muted"},N=()=>{p.search="",p.status="",V()},V=()=>{const s={search:p.search||void 0,status:p.status||void 0};c.get("/ssl",s,{preserveState:!0,preserveScroll:!0})},z=s=>{c.get("/ssl",{page:s},{preserveState:!0,preserveScroll:!0})};return(s,e)=>(l(),k(q,{title:"Certificados SSL"},{default:n(()=>[a(I,null,{default:n(()=>[t("div",J,[e[5]||(e[5]=t("div",null,[t("h1",{class:"text-2xl font-bold text-text"},"Certificados SSL"),t("p",{class:"text-sm text-text-muted mt-1"}," Gerencie certificados Let's Encrypt para seus domínios ")],-1)),t("div",O,[a(m,{onClick:M,disabled:v.value,variant:"ghost"},{icon:n(()=>[...e[2]||(e[2]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])]),default:n(()=>[i(" "+r(v.value?"Renovando...":"Renovar Expirados"),1)]),_:1},8,["disabled"]),a(m,{onClick:S,class:"bg-accent hover:bg-accent-light"},{icon:n(()=>[...e[3]||(e[3]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:n(()=>[e[4]||(e[4]=i(" Novo Certificado ",-1))]),_:1})])]),t("div",K,[a(f,{class:"p-4"},{default:n(()=>[t("div",Q,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-text-muted"},"Total",-1)),t("p",W,r(s.stats.total),1)]),e[7]||(e[7]=t("div",{class:"p-3 bg-muted/20 rounded-lg"},[t("svg",{class:"w-6 h-6 text-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})])],-1))])]),_:1}),a(f,{class:"p-4"},{default:n(()=>[t("div",X,[t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm text-text-muted"},"Válidos",-1)),t("p",Y,r(s.stats.valid),1)]),e[9]||(e[9]=t("div",{class:"p-3 bg-success/20 rounded-lg"},[t("svg",{class:"w-6 h-6 text-success",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4"})])],-1))])]),_:1}),a(f,{class:"p-4"},{default:n(()=>[t("div",Z,[t("div",null,[e[10]||(e[10]=t("p",{class:"text-sm text-text-muted"},"Expirando",-1)),t("p",tt,r(s.stats.expiring),1)]),e[11]||(e[11]=t("div",{class:"p-3 bg-warning/20 rounded-lg"},[t("svg",{class:"w-6 h-6 text-warning",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1))])]),_:1}),a(f,{class:"p-4"},{default:n(()=>[t("div",et,[t("div",null,[e[12]||(e[12]=t("p",{class:"text-sm text-text-muted"},"Expirados",-1)),t("p",st,r(s.stats.expired),1)]),e[13]||(e[13]=t("div",{class:"p-3 bg-danger/20 rounded-lg"},[t("svg",{class:"w-6 h-6 text-danger",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1))])]),_:1})]),a(f,{class:"p-4 mb-6 bg-yellow-50 border-yellow-200"},{default:n(()=>[t("div",ot,[e[29]||(e[29]=t("h3",{class:"font-medium text-yellow-800 mb-2"},"Debug Info - SSL",-1)),t("div",rt,[t("div",null,[e[14]||(e[14]=t("strong",null,"Certificates Total:",-1)),i(" "+r(s.certificates.total),1),e[15]||(e[15]=t("br",null,null,-1)),e[16]||(e[16]=t("strong",null,"Certificates Count:",-1)),i(" "+r(s.certificates.data.length),1),e[17]||(e[17]=t("br",null,null,-1)),e[18]||(e[18]=t("strong",null,"Current Page:",-1)),i(" "+r(s.certificates.current_page),1),e[19]||(e[19]=t("br",null,null,-1)),e[20]||(e[20]=t("strong",null,"Last Page:",-1)),i(" "+r(s.certificates.last_page),1)]),t("div",null,[e[21]||(e[21]=t("strong",null,"Stats Total:",-1)),i(" "+r(s.stats.total),1),e[22]||(e[22]=t("br",null,null,-1)),e[23]||(e[23]=t("strong",null,"Stats Valid:",-1)),i(" "+r(s.stats.valid),1),e[24]||(e[24]=t("br",null,null,-1)),e[25]||(e[25]=t("strong",null,"Stats Expiring:",-1)),i(" "+r(s.stats.expiring),1),e[26]||(e[26]=t("br",null,null,-1)),e[27]||(e[27]=t("strong",null,"Stats Expired:",-1)),i(" "+r(s.stats.expired),1)])]),t("div",nt,[e[28]||(e[28]=t("strong",null,"Sample Certificates:",-1)),t("pre",at,r(JSON.stringify(s.certificates.data.slice(0,2),null,2)),1)])])]),_:1}),a(f,{class:"p-4 mb-6"},{default:n(()=>[t("div",it,[t("div",lt,[y(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>p.search=o),type:"text",placeholder:"Buscar por domínio...",class:"w-full px-3 py-2 bg-elevated border border-border rounded-lg text-text placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent"},null,512),[[P,p.search]])]),t("div",dt,[y(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>p.status=o),class:"px-3 py-2 bg-elevated border border-border rounded-lg text-text focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent"},[...e[30]||(e[30]=[t("option",{value:""},"Todos os status",-1),t("option",{value:"valid"},"Válido",-1),t("option",{value:"expiring"},"Expirando",-1),t("option",{value:"expired"},"Expirado",-1),t("option",{value:"pending"},"Pendente",-1),t("option",{value:"failed"},"Falha",-1)])],512),[[H,p.status]]),a(m,{onClick:N,variant:"ghost"},{default:n(()=>[...e[31]||(e[31]=[i("Limpar",-1)])]),_:1})])])]),_:1}),a(f,null,{default:n(()=>[t("div",ut,[t("table",pt,[e[36]||(e[36]=t("thead",{class:"bg-elevated border-b border-border"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"Domínio Principal"),t("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"SAN Domains"),t("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"Status"),t("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"Expira em"),t("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"Auto Renovação"),t("th",{class:"px-4 py-3 text-center font-medium text-text-muted"},"Ações")])],-1)),t("tbody",null,[s.certificates.data.length===0?(l(),u("tr",xt,[...e[32]||(e[32]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-text-muted"}," Nenhum certificado SSL encontrado ",-1)])])):g("",!0),(l(!0),u(h,null,_(s.certificates.data,o=>(l(),u("tr",{key:o.id,class:"border-b border-border hover:bg-elevated/50"},[t("td",ct,[t("div",mt,r(o.domain_name),1),t("div",ft,r(o.domain?.name||"N/A"),1)]),t("td",vt,[o.san_domains&&o.san_domains.length?(l(),u("div",gt,[(l(!0),u(h,null,_(o.san_domains.slice(0,2),d=>(l(),u("div",{key:d,class:"text-sm text-text-muted"},r(d),1))),128)),o.san_domains.length>2?(l(),u("div",wt," +"+r(o.san_domains.length-2)+" mais ",1)):g("",!0)])):(l(),u("span",bt,"Nenhum"))]),t("td",kt,[t("span",{class:w(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-success/20 text-success":o.status==="valid","bg-danger/20 text-danger":o.status==="expired","bg-warning/20 text-warning":o.status==="expiring","bg-info/20 text-info":o.status==="pending","bg-red-500/20 text-red-400":o.status==="failed"}])},r(D(o.status)),3)]),t("td",yt,[o.expires_at?(l(),u("div",ht,[t("div",_t,r(L(o.expires_at)),1),t("div",{class:w(["text-sm",B(o.expires_at)])},r(A(o.expires_at)),3)])):(l(),u("span",Ct,"N/A"))]),t("td",St,[t("span",{class:w(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-success/20 text-success":o.auto_renew,"bg-muted/20 text-muted":!o.auto_renew}])},r(o.auto_renew?"Sim":"Não"),3)]),t("td",Et,[t("div",Tt,[o.status==="expiring"||o.status==="expired"?(l(),k(m,{key:0,onClick:d=>T(o),variant:"default",size:"sm"},{default:n(()=>[...e[33]||(e[33]=[i(" Renovar ",-1)])]),_:2},1032,["onClick"])):g("",!0),a(m,{onClick:d=>j(o),variant:o.auto_renew?"outline":"default",size:"sm"},{default:n(()=>[i(r(o.auto_renew?"Desativar Auto":"Ativar Auto"),1)]),_:2},1032,["onClick","variant"]),a(m,{onClick:d=>E(o),variant:"ghost",size:"sm"},{icon:n(()=>[...e[34]||(e[34]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]),_:2},1032,["onClick"]),a(m,{onClick:d=>$(o),variant:"danger",size:"sm"},{icon:n(()=>[...e[35]||(e[35]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])]),_:2},1032,["onClick"])])])]))),128))])])]),t("div",jt,[a(U,{"current-page":s.certificates.current_page,"total-pages":s.certificates.last_page,"total-items":s.certificates.total,"per-page":s.certificates.per_page,onNavigate:z},null,8,["current-page","total-pages","total-items","per-page"])])]),_:1})]),_:1})]),_:1}))}});export{zt as default};
