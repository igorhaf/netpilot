import{m as J,d as L,y as O,p as G,o as a,j as n,a as e,c as l,b as m,f as d,k as g,t as r,g as y,v as K,F as h,r as k,A as j,n as V,w as Q,q as b}from"./app-v6LMgA3I.js";import{_ as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-okXDLQlQ.js";import{a as x,_ as p}from"./Card.vue_vue_type_script_setup_true_lang-CCLiln8U.js";import{_ as X}from"./Badge.vue_vue_type_script_setup_true_lang-pViAJmLG.js";import{_ as Y}from"./Pagination.vue_vue_type_script_setup_true_lang-Dtc5XMYP.js";import{u as Z}from"./useToast-CYZclKNH.js";/* empty css            */const ee={class:"p-6"},te={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8"},se={class:"flex items-center gap-3 mt-4 sm:mt-0"},oe={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},re={class:"flex items-center justify-between"},ae={class:"text-2xl font-bold text-text"},ne={class:"flex items-center justify-between"},le={class:"text-2xl font-bold text-success"},ie={class:"flex items-center justify-between"},de={class:"text-2xl font-bold text-danger"},ue={class:"flex items-center justify-between"},ce={class:"text-2xl font-bold text-info"},pe={class:"flex flex-col sm:flex-row gap-4"},me={class:"flex-1"},xe={class:"flex gap-3"},fe=["value"],ve=["value"],ge={class:"overflow-x-auto"},be={class:"w-full text-sm"},_e={key:0,class:"border-b border-border"},ye={class:"px-4 py-3"},he={class:"flex items-center gap-2"},ke={class:"font-medium text-text"},we={class:"text-sm text-text-muted"},Ce={class:"px-4 py-3"},Me={class:"px-4 py-3"},Se={class:"font-medium text-text"},Le={class:"text-sm text-text-muted"},je={class:"px-4 py-3"},Ve={key:0,class:"text-sm"},Be={key:1,class:"text-sm text-info"},De={key:2,class:"text-sm text-text-muted"},Te={class:"px-4 py-3 text-center"},ze={class:"px-6 py-4 border-t border-border"},Ee={class:"p-6 border-b border-border"},Ae={class:"flex items-center justify-between"},Re={class:"text-sm text-text-muted"},$e={class:"p-6 overflow-y-auto max-h-96"},Fe={class:"space-y-4"},Ne={key:0,class:"space-y-2"},Pe={class:"bg-elevated border border-border rounded-lg p-4 text-sm text-text overflow-x-auto"},He={key:1,class:"space-y-2"},Ie={class:"bg-danger/10 border border-danger/20 rounded-lg p-4 text-sm text-danger overflow-x-auto"},Ue={key:2,class:"space-y-2"},qe={class:"bg-elevated border border-border rounded-lg p-4 text-sm text-text overflow-x-auto"},Ye=J({__name:"Index",props:{logs:{},stats:{},types:{},statuses:{},filters:{}},setup(B){const _=B,{success:w,error:C}=Z(),f=L(!1),i=L(null),u=O({search:_.filters.search||"",type:_.filters.type||"",status:_.filters.status||""}),M=()=>{f.value=!0,b.visit(window.location.pathname,{only:["logs","stats","types","statuses","filters"],preserveState:!1,preserveScroll:!1,onFinish:()=>{f.value=!1}})},D=()=>{confirm("Tem certeza que deseja limpar todos os logs (exceto os em execução)?")&&(f.value=!0,b.post("/logs/clear",{},{preserveState:!1,preserveScroll:!1,onSuccess:s=>{if(s.success){if(w(s.message||"Logs limpos com sucesso!"),s.details){const t=s.details;console.log("Detalhes da limpeza:",t),t.stuck_running_logs>0&&w(`Logs travados removidos: ${t.stuck_running_logs}`)}M()}else C(s.message||"Erro ao limpar logs")},onError:s=>{C("Erro ao limpar logs"),console.error("Erro:",s)},onFinish:()=>{f.value=!1}}))},T=s=>{i.value=s},S=()=>{i.value=null},z=s=>{switch(s){case"success":return"positive";case"failed":return"negative";case"running":return"info";case"pending":return"warning";default:return"neutral"}},E=s=>({nginx:"bg-blue-500/20 text-blue-400",traefik:"bg-green-500/20 text-green-400",ssl_renewal:"bg-yellow-500/20 text-yellow-400",proxy_update:"bg-purple-500/20 text-purple-400",domain:"bg-blue-500/20 text-blue-400",redirect:"bg-purple-500/20 text-purple-400"})[s]||"bg-muted/20 text-muted",A=s=>({issue_certificate:"Emissão de Certificado",domain_validation:"Validação do Domínio",port_check:"Verificação de Portas",environment_prep:"Preparação do Ambiente",certificate_issuance:"Emissão do Certificado",certificate_application:"Aplicação do Certificado",final_verification:"Verificação Final",renew_certificate:"Renovação de Certificado",renewal_preparation:"Preparação da Renovação",renewal_execution:"Execução da Renovação",renewal_verification:"Verificação da Renovação",revoke_certificate:"Revogação de Certificado",revocation_preparation:"Preparação da Revogação",revocation_execution:"Execução da Revogação",revocation_cleanup:"Limpeza da Revogação",create:"Criação",update:"Atualização",delete:"Exclusão"})[s]||s,R=s=>new Date(s).toLocaleDateString("pt-BR"),$=s=>new Date(s).toLocaleTimeString("pt-BR"),F=(s,t)=>{const o=new Date(s),I=new Date(t).getTime()-o.getTime(),v=Math.floor(I/1e3);if(v<60)return`${v}s`;const U=Math.floor(v/60),q=v%60;return`${U}m ${q}s`},N=()=>{u.search="",u.type="",u.status="",P()},P=()=>{const s={search:u.search||void 0,type:u.type||void 0,status:u.status||void 0};b.get(route("logs.index"),s,{preserveState:!0,preserveScroll:!0})},H=s=>{b.get(route("logs.index"),{page:s},{preserveState:!0,preserveScroll:!0})};return(s,t)=>(a(),G(W,{title:"Logs de Deployment"},{default:n(()=>[e("div",ee,[e("div",te,[t[8]||(t[8]=e("div",null,[e("h1",{class:"text-2xl font-bold text-text"},"Logs de Deployment"),e("p",{class:"text-sm text-text-muted mt-1"}," Acompanhe execuções de deploy do Nginx, Traefik e renovações SSL ")],-1)),e("div",se,[d(x,{onClick:M,variant:"ghost"},{icon:n(()=>[...t[4]||(t[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])]),default:n(()=>[t[5]||(t[5]=g(" Atualizar ",-1))]),_:1}),d(x,{onClick:D,variant:"outline"},{icon:n(()=>[...t[6]||(t[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])]),default:n(()=>[t[7]||(t[7]=g(" Limpar Logs ",-1))]),_:1})])]),e("div",oe,[d(p,{class:"p-4"},{default:n(()=>[e("div",re,[e("div",null,[t[9]||(t[9]=e("p",{class:"text-sm text-text-muted"},"Total",-1)),e("p",ae,r(s.stats.total),1)]),t[10]||(t[10]=e("div",{class:"p-3 bg-muted/20 rounded-lg"},[e("svg",{class:"w-6 h-6 text-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1))])]),_:1}),d(p,{class:"p-4"},{default:n(()=>[e("div",ne,[e("div",null,[t[11]||(t[11]=e("p",{class:"text-sm text-text-muted"},"Sucesso",-1)),e("p",le,r(s.stats.success),1)]),t[12]||(t[12]=e("div",{class:"p-3 bg-success/20 rounded-lg"},[e("svg",{class:"w-6 h-6 text-success",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4"})])],-1))])]),_:1}),d(p,{class:"p-4"},{default:n(()=>[e("div",ie,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-sm text-text-muted"},"Falhas",-1)),e("p",de,r(s.stats.failed),1)]),t[14]||(t[14]=e("div",{class:"p-3 bg-danger/20 rounded-lg"},[e("svg",{class:"w-6 h-6 text-danger",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1))])]),_:1}),d(p,{class:"p-4"},{default:n(()=>[e("div",ue,[e("div",null,[t[15]||(t[15]=e("p",{class:"text-sm text-text-muted"},"Executando",-1)),e("p",ce,r(s.stats.running),1)]),t[16]||(t[16]=e("div",{class:"p-3 bg-info/20 rounded-lg"},[e("svg",{class:"w-6 h-6 text-info",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]),_:1})]),d(p,{class:"p-4 mb-6"},{default:n(()=>[e("div",pe,[e("div",me,[y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>u.search=o),type:"text",placeholder:"Buscar nos logs...",class:"w-full px-3 py-2 bg-elevated border border-border rounded-lg text-text placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent"},null,512),[[K,u.search]])]),e("div",xe,[y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>u.type=o),class:"px-3 py-2 bg-elevated border border-border rounded-lg text-text focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent"},[t[17]||(t[17]=e("option",{value:""},"Todos os tipos",-1)),(a(!0),l(h,null,k(s.types,(o,c)=>(a(),l("option",{key:c,value:c},r(o),9,fe))),128))],512),[[j,u.type]]),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>u.status=o),class:"px-3 py-2 bg-elevated border border-border rounded-lg text-text focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent"},[t[18]||(t[18]=e("option",{value:""},"Todos os status",-1)),(a(!0),l(h,null,k(s.statuses,(o,c)=>(a(),l("option",{key:c,value:c},r(o),9,ve))),128))],512),[[j,u.status]]),d(x,{onClick:N,variant:"ghost"},{default:n(()=>[...t[19]||(t[19]=[g("Limpar",-1)])]),_:1})])])]),_:1}),d(p,null,{default:n(()=>[e("div",ge,[e("table",be,[t[23]||(t[23]=e("thead",{class:"bg-elevated border-b border-border"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"Tipo / Ação"),e("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"Status"),e("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"Iniciado em"),e("th",{class:"px-4 py-3 text-left font-medium text-text-muted"},"Duração"),e("th",{class:"px-4 py-3 text-center font-medium text-text-muted"},"Ações")])],-1)),e("tbody",null,[s.logs.data.length===0?(a(),l("tr",_e,[...t[20]||(t[20]=[e("td",{colspan:"5",class:"px-4 py-8 text-center text-text-muted"}," Nenhum log encontrado ",-1)])])):m("",!0),(a(!0),l(h,null,k(s.logs.data,o=>(a(),l("tr",{key:o.id,class:"border-b border-border hover:bg-elevated/50"},[e("td",ye,[e("div",he,[e("div",{class:V(["p-1 rounded",E(o.type)])},[...t[21]||(t[21]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])],2),e("div",null,[e("div",ke,r(s.types[o.type]||o.type),1),e("div",we,r(A(o.action)),1)])])]),e("td",Ce,[e("span",{class:V(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-success/20 text-success":o.status==="success","bg-danger/20 text-danger":o.status==="failed","bg-info/20 text-info":o.status==="running","bg-warning/20 text-warning":o.status==="pending"}])},r(s.statuses[o.status]||o.status),3)]),e("td",Me,[e("div",Se,r(R(o.created_at)),1),e("div",Le,r($(o.created_at)),1)]),e("td",je,[o.started_at&&o.completed_at?(a(),l("div",Ve,r(F(o.started_at,o.completed_at)),1)):o.status==="running"?(a(),l("div",Be," Executando... ")):(a(),l("div",De,"-"))]),e("td",Te,[d(x,{onClick:c=>T(o),variant:"ghost",size:"sm"},{icon:n(()=>[...t[22]||(t[22]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]),_:2},1032,["onClick"])])]))),128))])])]),e("div",ze,[d(Y,{"current-page":s.logs.current_page,"total-pages":s.logs.last_page,"total-items":s.logs.total,"per-page":s.logs.per_page,onNavigate:H},null,8,["current-page","total-pages","total-items","per-page"])])]),_:1})]),i.value?(a(),l("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:S},[e("div",{class:"bg-surface rounded-2xl border border-border max-w-4xl w-full max-h-[80vh] overflow-hidden",onClick:t[3]||(t[3]=Q(()=>{},["stop"]))},[e("div",Ee,[e("div",Ae,[e("div",null,[t[24]||(t[24]=e("h2",{class:"text-xl font-bold text-text"},"Detalhes do Log",-1)),e("p",Re,r(s.types[i.value.type])+" - "+r(i.value.action),1)]),d(x,{onClick:S,variant:"ghost"},{icon:n(()=>[...t[25]||(t[25]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),_:1})])]),e("div",$e,[e("div",Fe,[e("div",null,[t[26]||(t[26]=e("label",{class:"text-sm font-medium text-text-muted"},"Status:",-1)),d(X,{variant:z(i.value.status),class:"ml-2"},{default:n(()=>[g(r(s.statuses[i.value.status]),1)]),_:1},8,["variant"])]),i.value.output?(a(),l("div",Ne,[t[27]||(t[27]=e("label",{class:"text-sm font-medium text-text-muted"},"Saída:",-1)),e("pre",Pe,r(i.value.output),1)])):m("",!0),i.value.error?(a(),l("div",He,[t[28]||(t[28]=e("label",{class:"text-sm font-medium text-text-muted"},"Erro:",-1)),e("pre",Ie,r(i.value.error),1)])):m("",!0),i.value.payload?(a(),l("div",Ue,[t[29]||(t[29]=e("label",{class:"text-sm font-medium text-text-muted"},"Payload:",-1)),e("pre",qe,r(JSON.stringify(i.value.payload,null,2)),1)])):m("",!0)])])])])):m("",!0)]),_:1}))}});export{Ye as default};
